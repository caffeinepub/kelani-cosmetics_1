{
  "kind": "coverage_report",
  "version": "1.0",
  "generatedAt": "2026-02-09T23:16:01.576Z",
  "sources": {
    "buildRequest": true,
    "implementationPlan": true
  },
  "requirements": {
    "total": 6,
    "implemented": 4,
    "items": [
      {
        "id": "REQ-1",
        "summary": "Update the Motoko backend to return public product data with integrated active sale information (sale price, discount percentage, and on-sale flag) for these methods: `getProductsPageFeaturedFirst()`, `getHomepageCategories()`, and `getProduct()`. Sale fields must only be present/true when the sale is currently valid per strict time-window validation.",
        "status": "unknown",
        "plannedFiles": [],
        "matchedFiles": []
      },
      {
        "id": "REQ-2",
        "summary": "Implement a shared, reusable Motoko helper used by all three public product methods that resolves the active sale for a given product barcode by scanning `saleItems` and applying strict validation: sale must have `isActive == true` and current time must be within the sale period using system time (nanoseconds since Unix epoch). Enforce boundary rules so expired and future sales never return sale data.",
        "status": "unknown",
        "plannedFiles": [],
        "matchedFiles": []
      },
      {
        "id": "REQ-3",
        "summary": "Ensure the backend uses existing shared utilities/patterns for (a) BigInt/Int serialization of timestamps and (b) numeric conversion/price calculation consistency, and maintains existing function signatures where possible (or updates frontend bindings accordingly when signatures must change).",
        "status": "implemented",
        "plannedFiles": [
          "frontend/src/backend.d.ts",
          "frontend/src/hooks/useProductQueries.ts"
        ],
        "matchedFiles": [
          "frontend/src/hooks/useProductQueries.ts"
        ]
      },
      {
        "id": "REQ-4",
        "summary": "Update all public-facing frontend price displays to show sale pricing only when the backend indicates a currently-active valid sale, and never show sale pricing for expired or future sales. This must be consistent across: home page product cards, category page product cards, search results product cards, product details modal, and standalone product details page (`/product/$barcode`).",
        "status": "implemented",
        "plannedFiles": [
          "frontend/src/hooks/useCategoryProductsPaginated.ts",
          "frontend/src/components/public/products/ProductCard.tsx",
          "frontend/src/components/public/home/search/SearchResultItem.tsx",
          "frontend/src/components/public/product/ProductDetailsModal.tsx",
          "frontend/src/pages/public/ProductPage.tsx"
        ],
        "matchedFiles": [
          "frontend/src/hooks/useCategoryProductsPaginated.ts",
          "frontend/src/components/public/products/ProductCard.tsx",
          "frontend/src/components/public/home/search/SearchResultItem.tsx",
          "frontend/src/components/public/product/ProductDetailsModal.tsx",
          "frontend/src/pages/public/ProductPage.tsx"
        ]
      },
      {
        "id": "REQ-5",
        "summary": "Update the public product details page data flow so it can render sale-aware product details (sale price, discount percentage, on-sale flag) returned by the backend `getProduct()` (or an updated equivalent), rather than only rendering the base product price.",
        "status": "implemented",
        "plannedFiles": [
          "frontend/src/hooks/useProductQueries.ts",
          "frontend/src/pages/public/ProductPage.tsx"
        ],
        "matchedFiles": [
          "frontend/src/hooks/useProductQueries.ts",
          "frontend/src/pages/public/ProductPage.tsx"
        ]
      },
      {
        "id": "REQ-6",
        "summary": "Update the product details modal to include the discount percentage and a clear on-sale badge/label when a valid sale exists, matching the same strict on-sale rules as other public components.",
        "status": "implemented",
        "plannedFiles": [
          "frontend/src/components/public/product/ProductDetailsModal.tsx"
        ],
        "matchedFiles": [
          "frontend/src/components/public/product/ProductDetailsModal.tsx"
        ]
      }
    ]
  },
  "changedFiles": [
    "backend/main.mo",
    "backend/migration.mo",
    "build-request.json",
    "feature_evidence.json",
    "frontend-file-summaries.txt",
    "frontend-implementation-plan.json",
    "frontend/src/components/public/home/search/SearchResultItem.tsx",
    "frontend/src/components/public/product/ProductDetailsModal.tsx",
    "frontend/src/components/public/products/ProductCard.tsx",
    "frontend/src/hooks/useCategoryProductsPaginated.ts",
    "frontend/src/hooks/useProductQueries.ts",
    "frontend/src/pages/public/ProductPage.tsx",
    "project_state.json",
    "scratch/component-selection.json",
    "spec.md",
    "spec_vs_diff_report.json"
  ]
}